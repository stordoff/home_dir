Much credit to mathiasbynens for inspiration and some ideas for this
